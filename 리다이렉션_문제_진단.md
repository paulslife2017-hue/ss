# 🚨 리다이렉션 문제 진단 보고서

## 📅 진단일: 2025년 12월 31일

---

## ⚠️ 발견된 치명적 문제

### 현재 상태
```
seoulzen.com (non-www) → 307 리다이렉트 → www.seoulzen.com (www)
```

**실제 동작:**
1. 사용자가 `https://seoulzen.com` 접속
2. Vercel이 `https://www.seoulzen.com`으로 리다이렉트 (307)
3. www 버전이 최종 URL

**하지만 설정 파일은:**
- `vercel.json`: www → non-www로 리다이렉트 설정 ❌
- `_redirects`: www → non-www로 리다이렉트 설정 ❌

**결과:** 설정과 실제 동작이 **반대**!

---

## 🎯 문제의 핵심

### Google Search Console 문제
```
❌ sitemap.xml에는 https://seoulzen.com (non-www)
❌ 실제로는 https://www.seoulzen.com (www)로 리다이렉트
❌ Google이 혼란 → 색인 생성 실패
```

### SEO 영향
- 🚫 **중복 콘텐츠 문제**: 두 버전 모두 접근 가능
- 🚫 **링크 주스 분산**: non-www와 www 사이 분산
- 🚫 **크롤링 비효율**: 리다이렉트 체인
- 🚫 **색인 지연**: Google이 어느 버전을 색인할지 결정 못함

---

## ✅ 해결 방안: www로 통일 (권장)

### 이유
1. **현재 Vercel 자동 설정**: non-www → www 리다이렉트 이미 동작 중
2. **변경 최소화**: 현재 동작에 맞춰 설정만 수정
3. **Google 선호**: www 있는 버전 선호 (공식 권장)

### 수정할 파일

#### 1. vercel.json
```json
{
  "redirects": [
    {
      "source": "/:path*",
      "destination": "https://www.seoulzen.com/:path*",
      "permanent": true
    }
  ]
}
```

#### 2. public/_redirects
```
# Redirect non-www to www
https://seoulzen.com/* https://www.seoulzen.com/:splat 301!
```

#### 3. public/sitemap.xml
```xml
모든 URL을 https://www.seoulzen.com으로 변경
```

#### 4. public/robots.txt
```
Sitemap: https://www.seoulzen.com/sitemap.xml
```

---

## 🔄 또는: non-www로 통일 (대안)

### 이유
- Vercel 자동 리다이렉트 제거 필요
- 더 깔끔한 URL (www 없음)
- 짧은 URL

### 수정 방법
1. Vercel 도메인 설정에서 리다이렉트 방향 변경
2. vercel.json과 _redirects는 현재 그대로 유지
3. sitemap과 robots.txt는 이미 non-www

---

## 🎯 권장 사항: www로 통일

**이유:**
1. ✅ Vercel이 이미 non-www → www 리다이렉트 중
2. ✅ 설정 파일만 수정하면 됨
3. ✅ Google은 www 버전 선호
4. ✅ 기존 외부 링크 호환성

**단점:**
- URL이 조금 길어짐 (www. 4글자 추가)

---

## 📊 현재 vs 수정 후

### 현재 (문제)
```
https://seoulzen.com
  ↓ 307 리다이렉트 (Vercel 자동)
https://www.seoulzen.com
  ↓ 설정은 반대 (vercel.json)
혼란!
```

### 수정 후 (www 통일)
```
https://seoulzen.com
  ↓ 301 리다이렉트 (명시적)
https://www.seoulzen.com (최종)
  ↓
Google 색인 ✅
```

---

## 🚀 즉시 조치 필요

### 우선순위 1: Sitemap URL 변경
```bash
# 모든 seoulzen.com을 www.seoulzen.com으로 변경
sed -i 's|https://seoulzen.com|https://www.seoulzen.com|g' public/sitemap.xml
```

### 우선순위 2: robots.txt 변경
```bash
# Sitemap URL 수정
sed -i 's|https://seoulzen.com|https://www.seoulzen.com|g' public/robots.txt
```

### 우선순위 3: vercel.json 수정
```json
{
  "redirects": [
    {
      "source": "/:path*",
      "destination": "https://www.seoulzen.com/:path*",
      "permanent": true
    }
  ]
}
```

### 우선순위 4: _redirects 수정
```
# Redirect non-www to www
https://seoulzen.com/* https://www.seoulzen.com/:splat 301!
```

---

## 📝 체크리스트

### 즉시 수정
- [ ] sitemap.xml: seoulzen.com → www.seoulzen.com
- [ ] robots.txt: Sitemap URL 수정
- [ ] vercel.json: 리다이렉트 방향 수정
- [ ] _redirects: 리다이렉트 방향 수정

### 배포 후 확인
- [ ] https://seoulzen.com → www로 리다이렉트 확인
- [ ] https://www.seoulzen.com 정상 접속 확인
- [ ] sitemap 접근: https://www.seoulzen.com/sitemap.xml
- [ ] robots.txt 확인: https://www.seoulzen.com/robots.txt

### Google Search Console
- [ ] 속성 추가: https://www.seoulzen.com
- [ ] 또는 기존 속성에 www 버전 추가
- [ ] Sitemap 재제출: https://www.seoulzen.com/sitemap.xml
- [ ] 24시간 후 크롤링 확인

---

## 🎉 예상 효과

### 수정 전 (현재)
```
❌ 리다이렉트 방향 불일치
❌ Google 혼란
❌ 색인 생성 실패
❌ 크롤링 비효율
```

### 수정 후
```
✅ 명확한 정규 URL (www.seoulzen.com)
✅ Google이 어느 버전을 색인할지 명확
✅ 링크 주스 통합
✅ 빠른 색인 생성
✅ 24-48시간 내 크롤링 시작
```

---

**작성일**: 2025-12-31  
**상태**: 🚨 즉시 수정 필요  
**우선순위**: ⭐⭐⭐⭐⭐ (최고)
